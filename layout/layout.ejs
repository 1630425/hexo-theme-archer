<!DOCTYPE html>
<html>
    <%- partial('_partial/base-head') %>
    <% if (is_home()) { %>
        <body class="home-body">
    <% } else if(is_post()){ %>
        <body class="post-body">
    <% } else if(page.layout === "404") { %>
        <body class="four-zero-four-body">
    <% } else if(page.layout === "about") { %>
        <body class="about-body">
    <% } %>
    <%- partial('_partial/base-header') %>
    <div class="wrapper">
        <%- partial('_partial/base-background-image') %>
        <img class="loading" src="<%- url_for('assets/loading.svg') %>" style="display: block; margin: 6rem auto 0 auto; width: 6rem; height: 6rem;" />
        <script>
            function fontLoaded(){
                console.log('font loaded');
                if (document.getElementsByClassName('site-intro-meta')) {
                    document.getElementsByClassName('intro-title')[0].classList.add('intro-fade-in');
                    document.getElementsByClassName('intro-subtitle')[0].classList.add('intro-fade-in');
                    let postIntroTags = document.getElementsByClassName('post-intro-tags')[0],
                        postIntroMeat = document.getElementsByClassName('post-intro-meta')[0];
                    if (postIntroTags) {
                        postIntroTags.classList.add('post-fade-in');
                    }
                    if (postIntroMeat) {
                        postIntroMeat.classList.add('post-fade-in');
                    }
                }
            }

            WebFont.load({
                custom: {
                    families: ['Oswald-Regular']
                },
                loading: function () {  //所有字体开始加载
                    // console.log('loading');
                },
                active: function () {  //所有字体已渲染
                    fontLoaded();
                },
                inactive: function () { //字体预加载失败，无效字体或浏览器不支持加载
                    console.log('inactive: timeout');
                    fontLoaded();
                },
                timeout: 15000 // Set the timeout to two seconds
            });
        </script>
        <div class="container container-unloaded">
            <%- body %>
            <!-- profile -->
            <% if (is_home()) { %>
            <%- partial('_partial/base-profile') %>
            <% } %>
        </div>
        <%- partial('_partial/base-footer', {}, {cache: true}) %>
    </div>
    <!-- toc -->
    <% if(is_post() && theme.toc) { %>
    <div class="toc-wrapper">
        <div class="toc-catalog">
            CATALOG
        </div>
        <%- toc(page.content, {class: 'toc', list_number: true}) %>
    </div>
    <% } %>
    <div class="back-top">&#xe639;</div>
    <%- partial('_partial/sidebar/base-sidebar', {}, {cache: true}) %>
    <%- partial('./js-info.ejs') %>
    <!-- 不蒜子  -->
    <% if (theme.busuanzi) { %>
    <script async src="//dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>
    <% } %>
    <!-- CNZZ统计  -->
    <% if (theme.CNZZ_analytics) { %>
    <div style="display: none">
        <script src="https://s13.cnzz.com/z_stat.php?id=<%- theme.CNZZ_analytics %>&web_id=<%- theme.CNZZ_analytics %>" language="JavaScript"></script>
        <% } %>
    </div>
    </body>
</html>


